================================================================================
                    STIG COMPLIANCE REPORT - {{ inventory_hostname }}
================================================================================

Report Generated: {{ ansible_date_time.iso8601 }}
STIG Source: {{ stig_source_file | default('N/A') }}

--------------------------------------------------------------------------------
                              DEVICE INFORMATION
--------------------------------------------------------------------------------
Hostname:     {{ inventory_hostname }}
{% if device_info is defined %}
Model:        {{ device_info.model | default('N/A') }}
Version:      {{ device_info.version | default('N/A') }}
Serial:       {{ device_info.serialnum | default('N/A') }}
{% endif %}

--------------------------------------------------------------------------------
                            COMPLIANCE SUMMARY
--------------------------------------------------------------------------------
Total Checks:     {{ device_compliance_summary.total_checks | default(0) }}
Compliant:        {{ device_compliance_summary.compliant | default(0) }}
Non-Compliant:    {{ device_compliance_summary.non_compliant | default(0) }}
Compliance Score: {{ device_compliance_summary.compliance_percentage | default(0) }}%

================================================================================
                          NON-COMPLIANT FINDINGS
================================================================================
{% for result in device_compliance_results | selectattr('compliant', 'equalto', false) | list %}

[{{ result.severity }}] {{ result.stig_id }}
--------------------------------------------------------------------------------
Title:   {{ result.title }}
Status:  NON-COMPLIANT
Details: {{ result.details }}
{% if result.fix_commands and report_include_remediation_commands | default(true) %}

Remediation Commands:
{% for cmd in result.fix_commands %}
  {{ cmd }}
{% endfor %}
{% endif %}
{% else %}
No non-compliant findings. All checks passed!
{% endfor %}

================================================================================
                           COMPLIANT ITEMS
================================================================================
{% for result in device_compliance_results | selectattr('compliant', 'equalto', true) | list %}
[PASS] {{ result.stig_id }} - {{ result.title }} ({{ result.severity }})
{% endfor %}

================================================================================
                              END OF REPORT
================================================================================
Generated by Cisco STIG Compliance Automation Tool
